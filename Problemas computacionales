# Imports estándar
import numpy as np
import matplotlib.pyplot as plt
from scipy.linalg import expm, logm
from scipy.optimize import minimize, differential_evolution
!pip install qutip
import qutip as qt

# Configuración de visualización
plt.rcParams['figure.figsize'] = (10, 6)
plt.rcParams['font.size'] = 12
plt.rcParams['lines.linewidth'] = 2

# Fijar semilla para reproducibilidad
np.random.seed(42)

print("Configuración completada")
print(f"NumPy version: {np.__version__}")
print(f"QuTiP version: {qt.__version__}")

!pip install --upgrade --force-reinstall qiskit
from qiskit.circuit import QuantumCircuit, Parameter
from qiskit.quantum_info import SparsePauliOp
from qiskit.primitives.estimator import Estimator
from qiskit.algorithms.minimum_eigensolvers import VQE
from qiskit.algorithms.optimizers import COBYLA

# --- Parámetros y Componentes ---
H_op = SparsePauliOp(['ZI', 'IX'], coeffs=[2.0, 1.0]) # H=2*sigma_z + 1*sigma_x
theta = Parameter('θ')
ry_circuit = QuantumCircuit(1)
ry_circuit.ry(theta, 0)
initial_point = np.array([0.0])
estimator = Estimator()

# --- 1. Calcular el Costo ---
# Definir el rango de theta y el paso
num_points = 500
thetas = np.linspace(0, 2 * np.pi, num_points)

# Función para calcular E(theta) (costo) para cada punto
# La función 'calculate_cost' ya está definida en tu Colab.
cost_values = [calculate_cost(t) for t in thetas]

# --- 2. Preparar el Resultado Analítico (Problema 1) ---
E_min_analytic = -np.sqrt(5)
theta_min_analytic = np.arctan(0.5) + np.pi

# --- 3. Visualización Requerida ---
plt.figure(figsize=(10, 6))
plt.plot(thetas, cost_values, label=r'$E(\theta) = 2\cos(\theta) + \sin(\theta)$ (Simulado)')

# Marcar el mínimo analítico
plt.scatter(theta_min_analytic, E_min_analytic,
            color='red', marker='o', s=100,
            label=f'Mínimo Analítico: $E_{{min}}={E_min_analytic:.4f}$')

# Etiquetas y Título
plt.title(r'Superficie de Costo VQE para H=$2\sigma_{z}+\sigma_{x}$')
plt.xlabel(r'Parámetro $\theta$ (Radianes)')
plt.ylabel(r'Energía Esperada E($\theta$)')
plt.grid(True, linestyle='--', alpha=0.6)
plt.legend()
plt.show()
